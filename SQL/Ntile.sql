WITH sales_data AS(
  SELECT 'ORD001' AS order_id, 'P001' AS product_id, '2024-07' AS month, 1200 AS sales UNION ALL
  SELECT 'ORD002', 'P001', '2024-08', 1350 UNION ALL
  SELECT 'ORD003', 'P002', '2024-07', 1500 UNION ALL
  SELECT 'ORD004', 'P002', '2024-08', 1400 UNION ALL
  SELECT 'ORD005', 'P003', '2024-07', 1600 UNION ALL
  SELECT 'ORD006', 'P003', '2024-08', 1600 UNION ALL
  SELECT 'ORD007', 'P004', '2024-07', 1100 UNION ALL
  SELECT 'ORD008', 'P004', '2024-08', 1100 UNION ALL
  SELECT 'ORD009', 'P005', '2024-07', 1000 UNION ALL
  SELECT 'ORD010', 'P005', '2024-08', 1050 UNION ALL
  SELECT 'ORD011', 'P001', '2024-09', 1250 UNION ALL
  SELECT 'ORD012', 'P002', '2024-09', 1380 UNION ALL
  SELECT 'ORD013', 'P003', '2024-09', 1750 UNION ALL
  SELECT 'ORD014', 'P004', '2024-09', 1180 UNION ALL
  SELECT 'ORD015', 'P005', '2024-09', 980 UNION ALL
  SELECT 'ORD016', 'P001', '2024-10', 1300 UNION ALL
  SELECT 'ORD017', 'P002', '2024-10', 1420 UNION ALL
  SELECT 'ORD018', 'P003', '2024-10', 1800 UNION ALL
  SELECT 'ORD019', 'P004', '2024-10', 1200 UNION ALL
  SELECT 'ORD019', 'P004', '2024-10', 1000 UNION ALL
  SELECT 'ORD020', 'P005', '2024-10', 1100
)
SELECT * ,
NTILE(2) OVER(ORDER BY Sales DESC) AS buckets_2,
-- NTILE(2) OVER(PARTITION BY product_id ORDER BY Sales) AS buckets_2,
NTILE(4) OVER(ORDER BY Sales) AS buckets_4,
NTILE(8) OVER(ORDER BY Sales) AS buckets_8
FROM Sales_Data

