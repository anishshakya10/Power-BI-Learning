WITH sales_data AS(
  SELECT 'ORD001' AS order_id, 'P001' AS product_id, '2024-07' AS month, 1200 AS sales UNION ALL
  SELECT 'ORD002', 'P001', '2024-08', 1350 UNION ALL
  SELECT 'ORD003', 'P002', '2024-07', 1500 UNION ALL
  SELECT 'ORD004', 'P002', '2024-08', 1400 UNION ALL
  SELECT 'ORD005', 'P003', '2024-07', 1600 UNION ALL
  SELECT 'ORD006', 'P003', '2024-08', 1600 UNION ALL
  SELECT 'ORD007', 'P004', '2024-07', 1100 UNION ALL
  SELECT 'ORD008', 'P004', '2024-08', 1100 UNION ALL
  SELECT 'ORD009', 'P005', '2024-07', 1000 UNION ALL
  SELECT 'ORD010', 'P005', '2024-08', 1050 UNION ALL
  SELECT 'ORD011', 'P001', '2024-09', 1250 UNION ALL
  SELECT 'ORD012', 'P002', '2024-09', 1380 UNION ALL
  SELECT 'ORD013', 'P003', '2024-09', 1750 UNION ALL
  SELECT 'ORD014', 'P004', '2024-09', 1180 UNION ALL
  SELECT 'ORD015', 'P005', '2024-09', 980 UNION ALL
  SELECT 'ORD016', 'P001', '2024-10', 1300 UNION ALL
  SELECT 'ORD017', 'P002', '2024-10', 1420 UNION ALL
  SELECT 'ORD018', 'P003', '2024-10', 1800 UNION ALL
  SELECT 'ORD019', 'P004', '2024-10', 1200 UNION ALL
  SELECT 'ORD019', 'P004', '2024-10', 1000 UNION ALL
  SELECT 'ORD020', 'P005', '2024-10', 1100
)
SELECT 
MONTH,
sales,
LEAD(sales) OVER(ORDER BY Month) AS NextMonthSales,
LAG(sales) OVER(ORDER BY Month) AS PreviousMonthSales,
LEAD(sales,2,0) OVER(ORDER BY Month) AS TwoMonthAheadSales, 
LAG(sales,2,0) OVER(ORDER BY Month) AS TwoMonthAgoSales 
FROM Sales_Data

WITH sales_data AS(
  SELECT 'ORD001' AS order_id, 'P001' AS product_id, '2024-07' AS month, 1200 AS sales UNION ALL
  SELECT 'ORD002', 'P001', '2024-08', 1350 UNION ALL
  SELECT 'ORD003', 'P002', '2024-07', 1500 UNION ALL
  SELECT 'ORD004', 'P002', '2024-08', 1400 UNION ALL
  SELECT 'ORD005', 'P003', '2024-07', 1600 UNION ALL
  SELECT 'ORD006', 'P003', '2024-08', 1600 UNION ALL
  SELECT 'ORD007', 'P004', '2024-07', 1100 UNION ALL
  SELECT 'ORD008', 'P004', '2024-08', 1100 UNION ALL
  SELECT 'ORD009', 'P005', '2024-07', 1000 UNION ALL
  SELECT 'ORD010', 'P005', '2024-08', 1050 UNION ALL
  SELECT 'ORD011', 'P001', '2024-09', 1250 UNION ALL
  SELECT 'ORD012', 'P002', '2024-09', 1380 UNION ALL
  SELECT 'ORD013', 'P003', '2024-09', 1750 UNION ALL
  SELECT 'ORD014', 'P004', '2024-09', 1180 UNION ALL
  SELECT 'ORD015', 'P005', '2024-09', 980 UNION ALL
  SELECT 'ORD016', 'P001', '2024-10', 1300 UNION ALL
  SELECT 'ORD017', 'P002', '2024-10', 1420 UNION ALL
  SELECT 'ORD018', 'P003', '2024-10', 1800 UNION ALL
  SELECT 'ORD019', 'P004', '2024-10', 1200 UNION ALL
  SELECT 'ORD019', 'P004', '2024-10', 1000 UNION ALL
  SELECT 'ORD020', 'P005', '2024-10', 1100
)
SELECT 
MONTH,

----------------------------------------------------------------------------
LAG(sales) OVER(ORDER BY Month) AS PreviousMonthSales,
CONCAT(ROUND((LAG(sales) OVER(ORDER BY Month) - sales)/sales,2),'%') AS MoM_pct_previous_month,
-------------------------------------------------------------------------------
sales,
-----------------------------------------------------------------------------
LEAD(sales) OVER(ORDER BY Month) AS NextMonthSales,
CONCAT(ROUND((LEAD(sales) OVER(ORDER BY Month) - sales)/sales,2),'%') AS MoM_pct_next_month,
----------------------------------------------------------------------------
LEAD(sales,2,0) OVER(ORDER BY Month) AS TwoMonthAheadSales, 
LAG(sales,2,0) OVER(ORDER BY Month) AS TwoMonthAgoSales 
FROM Sales_Data

